version: '3.0'
services:
  app: &app
    build: &app-build
      context: .
      dockerfile: Dockerfile.development
    environment:
      LANGUAGE_SERVER_RUBY_REMOTE_ROOT: $PWD
    volumes:
      - mtsmfm-language-server-sync:/app:nocopy
      - home:/home/ruby
      - $HOME/.gitconfig:/home/ruby/.gitconfig:ro
      - $HOME/.ssh:/home/ruby/.ssh:ro
      - $HOME/.gem:/home/ruby/.gem
  ruby-2-4:
    <<: *app
  ruby-2-3:
    <<: *app
    build:
      <<: *app-build
      args:
        RUBY_VERSION: 2.3
  ruby-2-2:
    <<: *app
    build:
      <<: *app-build
      args:
        RUBY_VERSION: 2.2
volumes:
  mtsmfm-language-server-sync:
    external: true
  home:
